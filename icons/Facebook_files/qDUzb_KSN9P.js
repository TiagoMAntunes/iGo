if (self.CavalryLogger) { CavalryLogger.start_js(["XBOKP"]); }

__d("MessengerActionsIconSVGM4React.bs",["React"],(function(a,b,c,d,e,f){"use strict";function a(a){return b("React").createElement("svg",{height:"22px",width:"22px",viewBox:"0 0 36 36"},b("React").createElement("g",{id:"dots-3-horizontal",fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},b("React").createElement("g",{id:"Page-1",fill:a},b("React").createElement("path",{id:"Fill-1",d:"M7,18 C7,16.4815417 8.23154167,15.25 9.75,15.25 C11.2684583,15.25 12.5,16.4815417 12.5,18 C12.5,19.5189167 11.2684583,20.75 9.75,20.75 C8.23154167,20.75 7,19.5189167 7,18 Z M15.25,18 C15.25,16.4815417 16.4815417,15.25 18,15.25 C19.5184583,15.25 20.75,16.4815417 20.75,18 C20.75,19.5189167 19.5184583,20.75 18,20.75 C16.4815417,20.75 15.25,19.5189167 15.25,18 Z M23.5,18 C23.5,16.4815417 24.7315417,15.25 26.25,15.25 C27.7684583,15.25 29,16.4815417 29,18 C29,19.5189167 27.7684583,20.75 26.25,20.75 C24.7315417,20.75 23.5,19.5189167 23.5,18 Z"}))))}f.make=a}),null);
__d("MessengerContextualActions.react",["cx","ContextualLayerUpdateOnScroll","LayerHideOnBlur","Link.react","React","ReactAbstractContextualDialog","ReactLayer"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();a=b("React").PropTypes;var h=b("ReactLayer").createClass(b("ReactAbstractContextualDialog").createSpec({displayName:"MessengerContextualActionsDialog",theme:{wrapperClassName:"_hw2",arrowDimensions:{offset:12,length:12}}}));c=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.render=function(){return b("React").createElement("li",{className:"_hw4"},b("React").createElement(b("Link.react"),{className:"_hw5",onClick:this.props.onClick},this.props.children))};return c}(b("React").Component);c.propTypes={onClick:a.func};d=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.render=function(){var a=this.props,c=a.children;a=babelHelpers.objectWithoutPropertiesLoose(a,["children"]);return b("React").createElement(h,babelHelpers["extends"]({alignment:"center",behaviors:{ContextualLayerUpdateOnScroll:b("ContextualLayerUpdateOnScroll"),LayerHideOnBlur:b("LayerHideOnBlur")}},a,{onToggle:this.props.onToggle}),b("React").createElement("ul",{className:"_hw3"},c))};return c}(b("React").Component);d.propTypes={onToggle:a.func};d.Item=c;e.exports=d}),null);
__d("MessengerDeleteMessageDialogReact.bs",["fbt","bs_block","bs_curry","ReasonReact.bs","MessengerDialogReact.bs","MessengerDialogBodyReact.bs"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("ReasonReact.bs").reducerComponent("MessengerDeleteMessageDialogReact");function i(){return g._("Eliminar mensagem")}var j=g._("Tens a certeza de que queres eliminar esta mensagem?");function k(){return g._("Eliminar")}function l(a,c,d,e){return[h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],function(c){return b("ReasonReact.bs").element(void 0,void 0,b("MessengerDialogReact.bs").Dialog[0](void 0,a,void 0,c[1][0],void 0,void 0,void 0,void 0,[b("ReasonReact.bs").element(void 0,void 0,b("bs_curry")._3(b("MessengerDialogReact.bs").Header[0],void 0,void 0,i(0))),b("ReasonReact.bs").element(void 0,void 0,b("MessengerDialogBodyReact.bs").make(void 0,[j])),b("ReasonReact.bs").element(void 0,void 0,b("MessengerDialogReact.bs").Footer[0](void 0,void 0,[b("ReasonReact.bs").element(void 0,void 0,b("MessengerDialogReact.bs").CancelButton[0](d,[])),b("ReasonReact.bs").element(void 0,void 0,b("MessengerDialogReact.bs").Button[0](void 0,k(0),void 0,"danger",function(){return b("bs_curry")._1(c[3],0)},0,void 0,void 0,void 0,[]))]))]))},function(){return[!0]},h[10],function(a,d){return b("bs_block").__(2,[[!1],function(){return b("bs_curry")._1(c,0)}])},h[12]]}a=b("ReasonReact.bs").wrapReasonForJs(h,function(a){return l(a.onToggle,a.onDelete,a.onCancel,[])});f.component=h;f.renderDialogHeaderMsg=i;f.dialogBodyMsg=j;f.renderDialogButtonMsg=k;f.make=l;f.jsComponent=a}),null);
__d("SaveMessageUtils",["MessengerDotComSaveModule","QE2Logger","StoryAttachmentStyle","immutable"],(function(a,b,c,d,e,f){__p&&__p();var g=b("immutable").Set.of(b("StoryAttachmentStyle").FALLBACK,b("StoryAttachmentStyle").SHARE,b("StoryAttachmentStyle").EVENT,b("StoryAttachmentStyle").ATTACHED_STORY,b("StoryAttachmentStyle").MUSIC_AGGREGATION,b("StoryAttachmentStyle").AVATAR),h=b("immutable").Set.of(b("StoryAttachmentStyle").GROUP_SELL_PRODUCT_ITEM);a={isSavableMessageAttachment:function(a){__p&&__p();var c=!0;for(var d=0;d<a.length;d++){if(a[d]==b("StoryAttachmentStyle").GROUP_SELL_PRODUCT_ITEM)if(b("MessengerDotComSaveModule").can_save_for_sale_item_attachment!=null){b("QE2Logger").logExposureForUser("marketplace_www_messenger_save");return b("MessengerDotComSaveModule").can_save_for_sale_item_attachment}else return!1;if(h.has(a[d]))return!0;g.has(a[d])||(c=!1)}return c}};e.exports=a}),null);
__d("XMessengerDotComSaveController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/save/message/",{})}),null);
__d("MessengerMessageActions.react",["ix","cssVar","cx","fbt","Bootloader","ContextualLayerAutoFlipHorizontal","ContextualLayerHideOnScrollOut","ContextualLayerUpdateOnScroll","CurrentUser","FBClipboardLink.react","FBLogger","Image.react","JSResource","LayerHideOnBlur","LayerHideOnEscape","MessageReplyPermissions","MessengerEnvironment","MercuryThreadActions","MessagingThreadCustomizationSource","MessengerAdminGroupUtils","LazyComponent.react","MercuryAttachmentType","MercuryMessageActions","MessengerActionsIconSVGM4React.bs","MessengerDialogs.bs","MessengerDotComAndInboxM4Check.bs","MessengerContextualActions.react","MessengerDeleteMessageDialogReact.bs","MessengerMessage.bs","MessengerReactionsMenu.react","MessengerState.bs","StoryAttachmentStyle","React","ReasonBootloadOnRender.react","ReasonResource","WorkChatRedesignedMessageListCheck.re","AsyncRequest","CollectionsDisplaySurface","CollectionCurationMechanisms","MessengerConfig","MessengerDotComSaveModule","MessengerURIUtils.bs","SaveMessageUtils","SavedStateActions","URLMatcher","XMessengerDotComSaveController","asset","gkx","isMessengerMessageRemoved","qex","tooltipPropsFor"],(function(a,b,c,d,e,f,g,h,i,j){"use strict";__p&&__p();var k=b("MercuryThreadActions").get(),l=b("MessengerDeleteMessageDialogReact.bs").jsComponent,m=b("MessengerContextualActions.react").Item;a=b("React").PropTypes;c=b("React").createClass({displayName:"MessengerMessageActions",propTypes:{hasFormatting:a.func,isActive:a.bool,isDeletable:a.bool,isFromViewer:a.bool,isShowingOriginal:a.bool,includeReactions:a.bool,message:a.object.isRequired,onToggleOriginal:a.func,onShowMenu:a.func.isRequired,onReplyToMessage:a.func,isSavedView:a.bool},getDefaultProps:function(){return{isDeletable:!0}},getInitialState:function(){return{shown:!1,open:!1,hover:!1}},render:function(){var a=this,c=null;b("WorkChatRedesignedMessageListCheck.re").enabled?c=b("React").createElement(b("Image.react"),{src:this.state.hover?g("895434"):g("610910")}):b("CurrentUser").isWorkUser()?c=b("React").createElement(b("Image.react"),{src:g("559623")}):b("MessengerDotComAndInboxM4Check.bs").yes?c=b("MessengerActionsIconSVGM4React.bs").make(this.state.hover?"black":"rgba(0, 0, 0, 0.34)"):c=b("React").createElement(b("Image.react"),{src:g("559622")});var d=j._("Mais"),e=this.state.shown;e=e?null:b("tooltipPropsFor")(d,"above","center");return this.props.isActive?b("React").createElement("span",babelHelpers["extends"]({},e,{className:"_2rvp"+(b("MessengerDotComAndInboxM4Check.bs").yes?" _7i2l":""),ref:"actions",onClick:this._toggleShown,onMouseEnter:function(b){return a.setState({hover:!0})},onMouseLeave:function(b){return a.setState({hover:!1})}}),c,this.renderMenu(),this.renderLayers()):null},renderMenu:function(){var a=this;return!this.state.open?null:b("React").createElement(b("MessengerReactionsMenu.react"),{entryPoint:"dot_menu",message:this.props.message,onHide:this._hidePopover,refProp:function(){return a.refs.actions}})},_openPopover:function(){this.setState({open:!0,shown:!1})},_hidePopover:function(){this.setState({open:!1})},renderLayers:function(){if(!this.state.shown)return null;var a;this.props.isSavedView?a=this._getSaveListItems():b("isMessengerMessageRemoved")(this.props.message)?a=this._getRemovedTombstoneListItems():a=this._getThreadListItems();return b("React").createElement(b("MessengerContextualActions.react"),{behaviors:{ContextualLayerAutoFlipHorizontal:b("ContextualLayerAutoFlipHorizontal"),ContextualLayerHideOnScrollOut:b("ContextualLayerHideOnScrollOut"),ContextualLayerUpdateOnScroll:b("ContextualLayerUpdateOnScroll"),LayerHideOnEscape:b("LayerHideOnEscape"),LayerHideOnBlur:b("LayerHideOnBlur")},context:this.refs.actions,key:"dialog",onToggle:this._handleActionsToggle,shown:this.props.isActive},this._renderRetry(),a)},_getThreadListItems:function(){__p&&__p();var a,c=[];b("MessengerConfig").canSaveMessages&&!b("gkx")("843916")&&c.push(b("React").createElement(m,{key:"save-messenger",onClick:this._handleMessengerSave},this._renderSaveToMessengerItemMsg()));c.push(b("React").createElement(m,{key:"delete",onClick:this._handleDelete},this._renderActionItemMsg()));var d=this._getLinkToAttachment();d&&b("MessengerConfig").CopyAttachmentLink&&c.push(b("React").createElement(m,{key:"copy-link",onClick:this._handleLink},this._renderCopyAttachmentLinkMsg(d)));this.props.hasFormatting&&this.props.hasFormatting()&&this.props.onToggleOriginal&&c.push(b("React").createElement(m,{key:"view-source",onClick:this._handleToggleOriginal},this._renderShowOriginalMsg()));this._canSaveMessageToFacebook()&&!b("MessengerConfig").canSaveMessages&&!b("gkx")("843916")&&c.push(b("React").createElement(m,{key:"save",onClick:this._handleFacebookSave},this._renderSaveItemMsg()));b("MessengerConfig").ShowMessageLinks&&b("MessengerEnvironment").messengerui&&c.push(b("React").createElement(m,{key:"react",onClick:this._handleLink},this._renderLinkItemMsg()));this.props.includeReactions&&c.push(b("React").createElement(m,{key:"perma-link",onClick:this._openPopover},this._renderReactionMsg()));!b("MessengerEnvironment").messengerui&&this.props.onReplyToMessage&&b("MessageReplyPermissions").canReplyToMessage(this.props.message)&&c.push(b("React").createElement(m,{key:"reply-to-message",onClick:this._handleReplyToMessage},this._renderReplyToMessage()));d=b("MessengerState.bs").getThreadMetaNow(b("CurrentUser").getID(),this.props.message.thread_id);var e=d&&d.associated_object;a=d&&d.marketplace_thread_data&&(((a=d.marketplace_thread_data)!=null?a.for_sale_item:a)||((a=d.marketplace_thread_data)!=null?a.buyer_fbid:a)||((a=d.marketplace_thread_data)!=null?a.seller_fbid:a));this.props.message.body&&d&&!d.is_canonical&&b("MessengerAdminGroupUtils").canUpdateThreadDescription(d,b("CurrentUser").getID())&&b("MessengerConfig").ILPMBE&&!e&&!a&&c.push(b("React").createElement(m,{key:"set-as-description",onClick:this._handleSetAsDescription},this._renderSetAsDescription()));return c},_getSaveListItems:function(){var a=[];a.push(b("React").createElement(m,{key:"unsave-messenger",onClick:this._handleMessengerUnsave},this._renderUnsaveToMessengerItemMsg()));return a},_getRemovedTombstoneListItems:function(){return[b("React").createElement(m,{key:"delete",onClick:this._handleDelete},this._renderActionItemMsg())]},_toggleShown:function(a){var b=this;a.stopPropagation();this.setState({shown:!this.state.shown},function(){return b.props.onShowMenu(b.state.shown)})},_renderActionItemMsg:function(){return b("qex")._("721176")?j._("Remover"):j._("Eliminar")},_renderSaveToMessengerItemMsg:function(){return j._("Guardar")},_renderUnsaveToMessengerItemMsg:function(){return j._("Apagar")},_renderSaveItemMsg:function(){return b("CurrentUser").isWorkUser()?j._("Guardar no Workplace"):this._isMarketplaceAttachment()?j._("Guardar no Marketplace"):j._("Guardar no Facebook")},_renderReactionMsg:function(){return j._("Reagir")},_renderReplyToMessage:function(){return j._("Responder")},_renderSetAsDescription:function(){return j._("Definir descri\u00e7\u00e3o do grupo")},_renderShowOriginalMsg:function(){if(this.props.isShowingOriginal)return j._("Mostrar com formata\u00e7\u00e3o");else return j._("Mostrar original")},_renderCopyAttachmentLinkMsg:function(a){var c=j._("Copiar liga\u00e7\u00e3o para partilhar");return b("React").createElement(b("FBClipboardLink.react"),{suppress:!0,tooltip:c,value:a},c)},_renderLinkItemMsg:function(){var a=b("MessengerURIUtils.bs").getURIForMessage(this.props.message).getQualifiedURIBase().toString(),c=j._("Copiar liga\u00e7\u00e3o");return b("React").createElement(b("FBClipboardLink.react"),{suppress:!0,tooltip:"",value:a},c)},_renderRetry:function(){return!b("MessengerMessage.bs").hasError(this.props.message)?null:b("React").createElement(m,{onClick:this._handleRetry},j._("Tentar novamente"))},_handleActionsToggle:function(a){a||this._handleDeselect()},_handleDeselect:function(){var a=this;this.setState({shown:!1},function(){return a.props.onShowMenu(a.state.shown)})},_handleDelete:function(){var a=this,c=this.props.message;if(b("qex")._("721176")){this._handleRemove();return}b("MessengerDialogs.bs").showDialog(function(){return b("React").createElement(l,{onDelete:function(){b("MercuryMessageActions").get()["delete"](c.thread_id,[c.message_id])},onToggle:a._handleDialogToggle,onCancel:a._handleDeselect,isFromViewer:a.props.isFromViewer})})},_handleRemove:function(){var a=this,c=b("MessengerState.bs").getThreadMetaNow(b("CurrentUser").getID(),this.props.message.thread_id);b("Bootloader").loadModules(["RemoveMessageDialog"],function(b){b.showDialog(a.props.message,c.thread_unsendability_status,a.props.isFromViewer,a._handleDeselect)},"MessengerMessageActions.react")},_getLinkToAttachment:function(){var a=this.props.message;return(a=a)!=null?(a=a.attachments)!=null?(a=a[0])!=null?(a=a.share)!=null?a.uri:a:a:a:a},_isMarketplaceAttachment:function(){var a=this.props.message;if(!b("MessengerDotComSaveModule").enabled_messenger_save)return!1;a=(a=a)!=null?(a=a.attachments)!=null?(a=a[0])!=null?(a=a.share)!=null?a.style_list:a:a:a:a;if(a)for(var c=0;c<a.length;c++)if(a[c]===b("StoryAttachmentStyle").GROUP_SELL_PRODUCT_ITEM)return!0;return!1},_canSaveMessageToFacebook:function(){__p&&__p();var a=this.props.message;if(b("MessengerDotComSaveModule").enabled_messenger_save&&this._isSavableMessageAttachment())return!0;if(b("MessengerDotComSaveModule").enabled_messenger_save&&a.attachments&&a.attachments.length>0&&a.attachments[0].share&&a.attachments[0].share.media&&a.attachments[0].share.media.playable)return!0;if(b("MessengerDotComSaveModule").enabled_messenger_save){a=b("URLMatcher").match(a.body);if(a!=null&&a.length>0)return!0}return!1},_handleLink:function(){this._handleActionsToggle(!1)},_isSavableMessageAttachment:function(){__p&&__p();var a=this.props.message.attachments;if(!a||a.length===0)return!1;for(var c=0;c<a.length;c++){var d=a[c];if(d.share&&d.share.style_list){var e=d.share.style_list;e=b("SaveMessageUtils").isSavableMessageAttachment(e)}else e=d.attach_type===b("MercuryAttachmentType").VIDEO;if(!e)return!1}return!0},_handleFacebookSave:function(){var a=this,c=this.props.message,d=b("CollectionsDisplaySurface").MESSENGER_DOT_COM_MESSAGE,e=b("CollectionCurationMechanisms").RIGHT_CLICK;new(b("AsyncRequest"))().setURI(b("XMessengerDotComSaveController").getURIBuilder().getURI()).setData({action:b("SavedStateActions").SAVE,surface:d,mechanism:e,message_id:c.message_id}).send();b("MessengerDialogs.bs").showDialog(function(){return b("React").createElement(b("ReasonBootloadOnRender.react"),{loader:b("ReasonResource")(b("JSResource")("MessengerSaveMessageDialogReact.bs").__setRef("MessengerMessageActions.react")),placeholder:b("React").createElement("div",null),component:b("React").createElement(b("LazyComponent.react"),{onToggle:a._handleDialogToggle,isMarketplaceAttachment:a._isMarketplaceAttachment()})})});this._handleActionsToggle(!1)},_handleMessengerSave:function(){var a=this.props.message,c=b("CollectionsDisplaySurface").MESSENGER_DOT_COM_MESSAGE,d=b("CollectionCurationMechanisms").RIGHT_CLICK;new(b("AsyncRequest"))().setURI(b("XMessengerDotComSaveController").getURIBuilder().getURI()).setData({action:b("SavedStateActions").SAVE,surface:c,mechanism:d,message_id:a.message_id}).setHandler(this._showMessengerSaveConfirmationDialog).send();this._handleActionsToggle(!1)},_showMessengerSaveConfirmationDialog:function(a){var c=this;b("MessengerDialogs.bs").showDialog(function(){return b("React").createElement(b("ReasonBootloadOnRender.react"),{loader:b("ReasonResource")(b("JSResource")("MessengerSaveMessageDialogReact.bs").__setRef("MessengerMessageActions.react")),placeholder:b("React").createElement("div",null),component:b("React").createElement(b("LazyComponent.react"),{onToggle:c._handleDialogToggle})})})},_handleMessengerUnsave:function(){this._handleActionsToggle(!1)},_handleDialogToggle:function(a){a||b("MessengerDialogs.bs").removeDialog()},_handleRetry:function(){this._handleDeselect(),b("MercuryMessageActions").get().resend(this.props.message)},_handleToggleOriginal:function(){b("FBLogger")("messenger_dot_com").info("formatting_toggled"),this.props.onToggleOriginal&&this.props.onToggleOriginal(),this._handleActionsToggle(!1)},_handleReplyToMessage:function(){this._logReply(),this.props.onReplyToMessage&&this.props.onReplyToMessage(this.props.message),this._handleActionsToggle(!1)},_handleSetAsDescription:function(){if(b("MessengerState.bs").isEmptyLocalThread(b("CurrentUser").getID(),this.props.message.thread_id))return;k.changeGroupThreadDescription(this.props.message.thread_id,this.props.message.body,b("MessagingThreadCustomizationSource").SET_FROM_MESSAGE);this._handleActionsToggle(!1)},_logReply:function(){b("Bootloader").loadModules(["MessageReplyTypedLogger","MessageReplyEntryPoint","MessageReplyEvent"],function(a,c,d){a=new a();a.setEvent(d.REPLY_INITIATED).setIsWorkplace(b("CurrentUser").isWorkUser()).setEntryPoint(c.THREE_DOT_BUTTON).log()},"MessengerMessageActions.react")}});e.exports=c}),null);